<template>
  <div class="test-page">
    <h1>ğŸ§ª Axios å­¦ä¹ ç³»ç»Ÿæµ‹è¯•é¡µé¢</h1>

    <div class="button-group">
      <el-button type="primary" @click="runLesson1" size="large">
        è¿è¡Œç¬¬1è¯¾ï¼šAxios ç®€ä»‹
      </el-button>

      <el-button type="success" @click="runLesson2" size="large">
        è¿è¡Œç¬¬2è¯¾ï¼šHTTP æ–¹æ³•
      </el-button>

      <el-button type="info" @click="runLesson8" size="large">
        è¿è¡Œç¬¬8è¯¾ï¼šæ‹¦æˆªå™¨
      </el-button>

      <el-button type="warning" @click="showProgress" size="large">
        æŸ¥çœ‹å­¦ä¹ è¿›åº¦
      </el-button>
    </div>

    <div class="test-section">
      <h2>æµ‹è¯•å°è£…çš„è¯·æ±‚å·¥å…·</h2>

      <el-space>
        <el-button @click="testGet">æµ‹è¯• GET è¯·æ±‚</el-button>
        <el-button @click="testPost">æµ‹è¯• POST è¯·æ±‚</el-button>
        <el-button @click="testError">æµ‹è¯•é”™è¯¯å¤„ç†</el-button>
        <el-button @click="testCancel">æµ‹è¯•è¯·æ±‚å–æ¶ˆ</el-button>
      </el-space>
    </div>

    <div class="console-output">
      <h3>ğŸ“ æ§åˆ¶å°è¾“å‡º</h3>
      <div class="console-content">
        <p>è¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†è¾“å‡º</p>
        <p>æˆ–è€…ç‚¹å‡»ä¸Šé¢çš„æŒ‰é’®è¿è¡Œæµ‹è¯•</p>
      </div>
    </div>

    <div class="quick-start">
      <h2>ğŸ’¡ å¿«é€Ÿå¼€å§‹</h2>
      <el-card>
        <template #header>
          <div class="card-header">
            <span>åœ¨æ§åˆ¶å°ä¸­è¿è¡Œ</span>
          </div>
        </template>
        <pre><code>// å¯¼å…¥å­¦ä¹ æ¨¡å—
import axiosLearning from '@/axios-learning/quick-start'

// å¼€å§‹å­¦ä¹ 
axiosLearning.start()

// è¿è¡Œç¬¬1è¯¾
axiosLearning.runLesson(1)

// æŸ¥çœ‹è¿›åº¦
axiosLearning.showProgress()

// è¿è¡Œä¸‹ä¸€è¯¾
axiosLearning.nextLesson()</code></pre>
      </el-card>
    </div>

    <div class="full-learning-system">
      <h2>ğŸ“ å®Œæ•´å­¦ä¹ ç³»ç»Ÿ</h2>
      <el-button type="primary" size="large" @click="openLearningSystem">
        æ‰“å¼€å¯è§†åŒ–å­¦ä¹ é¡µé¢
      </el-button>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ElMessage } from 'element-plus'
import axiosLearning from '@/axios-learning/quick-start'
import request from '@/utils/request'

// è¿è¡Œè¯¾ç¨‹
const runLesson1 = () => {
  console.clear()
  axiosLearning.runLesson(1)
  ElMessage.success('ç¬¬1è¯¾å·²è¿è¡Œï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°')
}

const runLesson2 = () => {
  console.clear()
  axiosLearning.runLesson(2)
  ElMessage.success('ç¬¬2è¯¾å·²è¿è¡Œï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°')
}

const runLesson8 = () => {
  console.clear()
  axiosLearning.runLesson(8)
  ElMessage.success('ç¬¬8è¯¾å·²è¿è¡Œï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°')
}

const showProgress = () => {
  console.clear()
  axiosLearning.showProgress()
  ElMessage.info('å­¦ä¹ è¿›åº¦å·²è¾“å‡ºåˆ°æ§åˆ¶å°')
}

// æµ‹è¯•è¯·æ±‚å·¥å…·
const testGet = async () => {
  try {
    console.log('æµ‹è¯• GET è¯·æ±‚...')
    const data = await request.get('https://jsonplaceholder.typicode.com/posts/1')
    console.log('âœ… GET è¯·æ±‚æˆåŠŸï¼š', data)
    ElMessage.success('GET è¯·æ±‚æˆåŠŸ')
  } catch (error) {
    console.error('âŒ GET è¯·æ±‚å¤±è´¥ï¼š', error)
  }
}

const testPost = async () => {
  try {
    console.log('æµ‹è¯• POST è¯·æ±‚...')
    const data = await request.post('https://jsonplaceholder.typicode.com/posts', {
      title: 'Test',
      body: 'Test body',
      userId: 1
    })
    console.log('âœ… POST è¯·æ±‚æˆåŠŸï¼š', data)
    ElMessage.success('POST è¯·æ±‚æˆåŠŸ')
  } catch (error) {
    console.error('âŒ POST è¯·æ±‚å¤±è´¥ï¼š', error)
  }
}

const testError = async () => {
  try {
    console.log('æµ‹è¯•é”™è¯¯å¤„ç†...')
    await request.get('https://jsonplaceholder.typicode.com/posts/99999')
  } catch (error: any) {
    console.log('âœ… é”™è¯¯å·²æ•è·ï¼š', error.message)
    ElMessage.warning('é”™è¯¯å¤„ç†æµ‹è¯•å®Œæˆ')
  }
}

const testCancel = () => {
  console.log('æµ‹è¯•è¯·æ±‚å–æ¶ˆ...')
  // è¿™é‡Œå¯ä»¥æ·»åŠ è¯·æ±‚å–æ¶ˆçš„æµ‹è¯•ä»£ç 
  ElMessage.info('è¯·æ±‚å–æ¶ˆåŠŸèƒ½æµ‹è¯•ï¼ˆè¯·æŸ¥çœ‹æ§åˆ¶å°ï¼‰')
}

// æ‰“å¼€å®Œæ•´å­¦ä¹ ç³»ç»Ÿ
const openLearningSystem = () => {
  ElMessage.info('å®Œæ•´å­¦ä¹ ç³»ç»Ÿç»„ä»¶ï¼šsrc/components/AxiosLearning.vue')
  console.log('ä½ å¯ä»¥åœ¨è·¯ç”±ä¸­æ·»åŠ è¯¥ç»„ä»¶ï¼Œæˆ–ç›´æ¥åœ¨ App.vue ä¸­ä½¿ç”¨')
}
</script>

<style scoped lang="scss">
.test-page {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 2rem;

  h1 {
    text-align: center;
    color: #409eff;
    margin-bottom: 2rem;
  }

  h2 {
    margin: 2rem 0 1rem 0;
    color: #333;
  }

  h3 {
    margin: 1rem 0;
  }

  .button-group {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 3rem;
  }

  .test-section {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    margin-bottom: 2rem;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  }

  .console-output {
    background: #f5f7fa;
    padding: 1.5rem;
    border-radius: 8px;
    margin-bottom: 2rem;

    .console-content {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 1rem;
      border-radius: 4px;
      font-family: 'Consolas', 'Monaco', monospace;
      min-height: 100px;
    }
  }

  .quick-start {
    margin-bottom: 2rem;

    pre {
      background: #f5f7fa;
      padding: 1rem;
      border-radius: 4px;
      overflow-x: auto;

      code {
        font-family: 'Consolas', 'Monaco', monospace;
        font-size: 0.9rem;
        line-height: 1.6;
      }
    }
  }

  .full-learning-system {
    text-align: center;
    padding: 2rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 8px;
    color: white;

    h2 {
      color: white;
    }
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
}
</style>
